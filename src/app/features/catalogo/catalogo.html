<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h2 class="mb-0">Catálogo de propiedades</h2>
      <small class="text-muted">Propiedades cargadas desde el sistema Manque</small>
    </div>
  </div>

  <!-- Mensajes de estado -->
  <div *ngIf="cargando" class="alert alert-info py-2">Cargando propiedades...</div>
  <div *ngIf="error" class="alert alert-danger py-2">{{ error }}</div>

  <!-- Lista de propiedades -->
  <div class="row g-3">
    <div class="col-md-4" *ngFor="let p of propiedades">
      <div class="card h-100 shadow-sm">
        <!-- Imagen principal -->
        <ng-container *ngIf="p.fotos && p.fotos.length > 0; else sinFoto">
          <img
            [src]="p.fotos[0].url"
            class="card-img-top"
            style="height: 180px; object-fit: cover;"
          />
        </ng-container>
        <ng-template #sinFoto>
          <div
            class="d-flex align-items-center justify-content-center bg-secondary text-white"
            style="height: 180px;"
          >
            <span>Sin foto disponible</span>
          </div>
        </ng-template>
        
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ p.titulo }}</h5>
          <p class="card-text mb-1">
            <strong>{{ p.ciudad }}</strong> · {{ p.tipo | titlecase }}
          </p>
          <p class="card-text mb-1">
            Dormitorios: {{ p.dormitorios }} · Baños: {{ p.baos }}
          </p>
          <p class="card-text fw-semibold text-success mb-3">
            {{ p.precio | currency:'CLP':'symbol':'1.0-0' }}
          </p>
          <div class="mt-auto">
            <a
              [routerLink]="['/propiedad', p.id]"
              class="btn btn-primary btn-sm w-100"
            >
              Ver detalle
            </a>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="!cargando && !error && propiedades.length === 0" class="col-12">
      <div class="alert alert-warning">No se encontraron propiedades.</div>
    </div>
  </div>
</div>
